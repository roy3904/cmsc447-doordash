<!DOCTYPE html5>

<html>
    <head>
        <title>GritDash</title>
        <link rel="stylesheet" href="homepage-style.css">
        <script src="https://kit.fontawesome.com/5d92ce3398.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <header class="nav-bar">
            <div class="header-container">
                <img class="nav-logo" src="images/gritdash-logo-1.png">
                <a class="nav-link" href="homepage.html">Home</a>
                <a class="nav-link">Worker Portal</a>
                <a class="nav-link" href="admin.html">Admin Portal</a>
            </div>
                <a href="cart.html" aria-label="Cart" style="color:inherit;text-decoration:none;">
                    <i class="fa-solid fa-cart-shopping badge" style="font-size:22px;">
                        <span id="cart-count" class="badge-count">0</span>
                    </i>
                </a>
                <script src="scripts/cart-common.js"></script>
        </header>

        <p class="home-title">Restaurants Available For Delivery</p>

        <div class="restaurants-container" id="restaurants-container">
            <!-- Restaurants dynamically load here -->
        </div>
        
        <footer>
            <img class="footer-logo" src="images/gritdash-logo-1.png">
        </footer>

        <script>
            document.addEventListener('DOMContentLoaded', async () => {
                try {
                    const response = await fetch('/api/restaurants');
                    const { restaurants } = await response.json();
                    const container = document.getElementById('restaurants-container');

                    restaurants.forEach(restaurant => {
                        const restaurantItem = document.createElement('div');
                        restaurantItem.className = 'restaurant-item';

                        const restaurantImg = document.createElement('img');
                        restaurantImg.className = 'restaurant-img';
                        

                        const restaurantInfo = document.createElement('div');
                        restaurantInfo.className = 'restaurant-info';

                        const restaurantName = document.createElement('p');
                        restaurantName.className = 'restaurant-name';
                        restaurantName.textContent = restaurant.Name;
                        restaurantInfo.appendChild(restaurantName);

                        restaurantImg.src = `images/${encodeURIComponent(restaurant.logoFile)}`;
                        restaurantImg.alt = `${restaurant.Name} Logo`;
                        restaurantItem.appendChild(restaurantImg);

                        const restaurantButton = document.createElement('button');
                        restaurantButton.className = 'restaurant-button';
                        restaurantButton.textContent = 'Pick Restaurant';
                        restaurantButton.addEventListener('click', () => {
                            // TODO: Dynamically route to restaurant page
                            window.location.href = `restaurant.html?restaurantId=${restaurant.RestaurantID}`;
                        });
                        restaurantInfo.appendChild(restaurantButton);

                        restaurantItem.appendChild(restaurantInfo);
                        container.appendChild(restaurantItem);
                    });
                } catch (error) {
                    console.error('Failed to load restaurants:', error);
                    const container = document.getElementById('restaurants-container');
                    container.textContent = 'Failed to load restaurants.';
                }
            });
        </script>
    </body>
</html>